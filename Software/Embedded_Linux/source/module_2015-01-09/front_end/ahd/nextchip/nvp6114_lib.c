/**
 * @file nvp6114_lib.c
 * NextChip NVP6114 4CH AHD1.0 RX and 9CH Audio Codec Library
 * Copyright (C) 2014 GM Corp. (http://www.grain-media.com)
 *
 * $Revision: 1.8 $
 * $Date: 2014/08/05 06:01:51 $
 *
 * ChangeLog:
 *  $Log: nvp6114_lib.c,v $
 *  Revision 1.8  2014/08/05 06:01:51  ccsu
 *  [audio] add set bank1 0xd5 = 0x01 for ACLK_PB is master
 *
 *  Revision 1.7  2014/07/31 06:25:20  jerson_l
 *  1. fix SD video format detect error probelm in AHD 720P@25 mode
 *
 *  Revision 1.6  2014/07/28 06:15:27  jerson_l
 *  1. update driver library to v0.3.1
 *  2. remove 720H support
 *
 *  Revision 1.5  2014/07/21 04:03:28  jerson_l
 *  1. support get channel video input format proc node and ioctl
 *  2. add module parameter for specify VCH start index
 *
 *  Revision 1.4  2014/06/23 03:25:53  ccsu
 *  add audio part
 *
 *  Revision 1.3  2014/06/16 02:37:36  jerson_l
 *  1. fix channel sequence not stable probelm in dual edge clock mode
 *
 *  Revision 1.2  2014/06/05 02:18:07  jerson_l
 *  1. support 720H/960H/Hibrid video mode
 *
 *  Revision 1.1.1.1  2014/04/22 08:16:36  jerson_l
 *  add nvp6114 driver
 *
 */

#include <linux/version.h>
#include <linux/types.h>
#include <linux/module.h>
#include <linux/kernel.h>
#include <linux/string.h>
#include <linux/delay.h>

#include "nextchip/nvp6114.h"        ///< from module/include/front_end/ahd

extern int audio_chnum;

/* AB => BA */
#define SWAP_2CHANNEL(x)    do { (x) = (((x) & 0xF0) >> 4 | ((x) & 0x0F) << 4); } while(0);
/* ABCD => CDAB */
#define SWAP_4CHANNEL(x)    do { (x) = (((x) & 0xFF00) >> 8 | ((x) & 0x00FF) << 8); } while(0);
/* ABCDEFGH => GHEFCDAB */
#define SWAP_8CHANNEL(x)    do { (x) = (((x) & 0xFF000000) >> 24 | ((x) & 0x00FF0000) >> 8 | ((x) & 0x0000FF00) << 8 | ((x) & 0x000000FF) << 24); } while(0);


/***************************************************************************************
 * NTSC Common
 ***************************************************************************************/
static unsigned char NVP6114_B0_NTSC[] = {
      // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0a 0x0b 0x0c 0x0d 0x0e 0x0f
/*0x00*/ 0x00,0x00,0x20,0x03,0x00,0x00,0xaf,0x00,0x60,0x60,0x60,0x60,0x08,0x08,0x08,0x08,
/*0x10*/ 0x88,0x88,0x88,0x88,0x90,0x90,0x90,0x90,0x00,0x00,0x00,0x00,0x04,0x04,0x04,0x04,
/*0x20*/ 0x00,0x00,0x00,0x00,0x2f,0x92,0x0b,0x43,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x30*/ 0x17,0x17,0x17,0x17,0x2f,0x92,0x0b,0x43,0x0a,0x0a,0x0a,0x0a,0x84,0x84,0x84,0x84,
/*0x40*/ 0xfd,0xfd,0xfd,0xfd,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x04,0x04,0x04,0x04,
/*0x50*/ 0x04,0x04,0x04,0x04,0xf1,0x10,0x10,0x00,0xa0,0xa0,0xa0,0xa0,0x9e,0x9e,0x9e,0x9e,
/*0x60*/ 0x00,0x00,0x00,0x00,0x8d,0x8d,0x8d,0x8d,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x70*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x88,0x88,0x11,0x11,0x00,0x00,0x00,0x00,
/*0x80*/ 0x00,0x00,0x02,0x80,0x04,0x04,0x08,0x04,0x0c,0x00,0x08,0x0e,0x80,0x20,0x0a,0x08,
/*0x90*/ 0x30,0x42,0x80,0x0a,0x7a,0x88,0x6c,0x5e,0x18,0x1f,0x8e,0x94,0xc7,0xa3,0xa0,0x0a,
/*0xa0*/ 0x00,0x00,0x02,0x80,0x04,0x04,0x08,0x04,0x0c,0x00,0x08,0x0e,0x80,0x20,0x0a,0x08,
/*0xb0*/ 0x30,0x42,0x80,0x0a,0x7a,0x88,0x6c,0x5e,0x18,0x1f,0x8e,0x94,0xc7,0xa3,0xa0,0x0a,
/*0xc0*/ 0x01,0x01,0x01,0x01,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x00,0x00,0x00,0x00,
/*0xd0*/ 0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xe0*/ 0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xf0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};

static unsigned char NVP6114_B1_NTSC[] = {
      // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0a 0x0b 0x0c 0x0d 0x0e 0x0f
/*0x00*/ 0x02,0x0f,0x0f,0x0f,0x0f,0x0f,0x1b,0x80,0x03,0x00,0x10,0x32,0x54,0x76,0x00,0x98,
/*0x10*/ 0xba,0xdc,0xfe,0x00,0x00,0x00,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,
/*0x20*/ 0x88,0x88,0x03,0x19,0x18,0x16,0x00,0x00,0x00,0x88,0xff,0x40,0xaa,0xaa,0xaa,0xaa,
/*0x30*/ 0xaa,0x82,0x00,0x00,0x00,0x8c,0xa0,0x00,0x18,0x01,0x80,0x30,0x00,0x00,0x80,0x00,
/*0x40*/ 0x0f,0x0f,0x0f,0x0f,0x11,0xcc,0x81,0x55,0x60,0x00,0x03,0x10,0x00,0x00,0x00,0x00,
/*0x50*/ 0xdd,0x00,0x00,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x60*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x70*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x80*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x90*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xa0*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xb0*/ 0xff,0xff,0xff,0xff,0x40,0x30,0x40,0x30,0x40,0x30,0x40,0x30,0x00,0x00,0x00,0x00,
/*0xc0*/ 0x10,0x10,0x32,0x32,0x10,0x32,0x54,0x76,0x22,0x88,0x03,0x00,0x60,0x60,0x70,0x70,
/*0xd0*/ 0x00,0x00,0x00,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x0f,0x0f,0xff,0x00,0x02,0x00,
/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x90,0x00,0x00,0x00,0x0f,0x0f,0x0f,0xff,
/*0xf0*/ 0xff,0xaa,0x66,0x00,0x83,0x70,0x00,0x1a,0x00,0x00,0x00,0x00,0xff,0xff,0xff,0x00
};

static unsigned char  NVP6114_B2_NTSC[] = {
      // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0a 0x0b 0x0c 0x0d 0x0e 0x0f
/*0x00*/ 0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,
/*0x10*/ 0x00,0x00,0x00,0x00,0xc0,0x00,0x55,0x55,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x20*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x30*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x40*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x50*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x60*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x70*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x80*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x90*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xa0*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xb0*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xc0*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xd0*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xf0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x74,0x00,0x74,0x00,0xff,0xff,0xff,0x00
};

static unsigned char NVP6114_B3_NTSC[] = {
      // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0a 0x0b 0x0c 0x0d 0x0e 0x0f
/*0x00*/ 0xe0,0x0f,0x0c,0x1f,0x00,0x24,0x60,0x80,0x50,0x38,0x0f,0x00,0x04,0x10,0x30,0x00,
/*0x10*/ 0x06,0x06,0x00,0x80,0x37,0x80,0x49,0x37,0xef,0xdf,0xdf,0x08,0x50,0x0c,0xff,0x88,
/*0x20*/ 0x84,0x20,0x23,0x00,0x2a,0xdd,0xf0,0x57,0x90,0x70,0x52,0x78,0x04,0x68,0x00,0x07,
/*0x30*/ 0xe0,0x43,0xa2,0x00,0x00,0x15,0x25,0x00,0x00,0x02,0x02,0x00,0x00,0x00,0x00,0x00,
/*0x40*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x00,0x44,0xaa,0x00,0x00,0x00,0x00,0x00,
/*0x50*/ 0x04,0xff,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x60,0x00,0x00,0x30,
/*0x60*/ 0x53,0x53,0x20,0x00,0x22,0x22,0x22,0x22,0x00,0x00,0x00,0x00,0xff,0xff,0xff,0xff,
/*0x70*/ 0xc0,0x01,0x06,0x06,0x11,0x00,0x0f,0x8f,0x0f,0x0f,0x0f,0x8f,0x0f,0x0f,0x00,0x00,
/*0x80*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x90*/ 0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x48,0x84,0x00,0x80,0x00,0x00,0x00,0x00,
/*0xa0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xb0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xc0*/ 0x10,0x30,0x0c,0x50,0x10,0x34,0x70,0x5c,0x20,0x20,0x30,0x40,0x20,0x20,0x14,0x20,
/*0xd0*/ 0x40,0x50,0x0e,0x00,0x80,0x80,0x00,0x00,0x39,0xb2,0x05,0x00,0xc0,0x00,0x00,0x00,
/*0xe0*/ 0xa0,0x00,0x01,0x01,0x02,0xa0,0x02,0x05,0x04,0x0b,0xa0,0x06,0x17,0x08,0x30,0x00,
/*0xf0*/ 0x09,0xa0,0xf8,0x00,0x00,0x00,0x00,0x00,0x01,0x05,0x87,0x0b,0x8e,0x11,0x64,0x00
};

static unsigned char NVP6114_B4_NTSC[] = {
      // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0a 0x0b 0x0c 0x0d 0x0e 0x0f
/*0x00*/ 0x02,0x04,0x06,0x08,0x0c,0x10,0x14,0x18,0x1c,0x20,0x28,0x30,0x38,0x40,0x48,0x50,
/*0x10*/ 0x58,0x60,0x68,0x70,0x78,0x7f,0x87,0x8f,0x97,0x9f,0xaf,0xbf,0xcf,0xdf,0xef,0xff,
/*0x20*/ 0x01,0x03,0x05,0x07,0x0b,0x0f,0x13,0x17,0x1b,0x1f,0x27,0x2f,0x37,0x3f,0x47,0x4f,
/*0x30*/ 0x57,0x5f,0x67,0x6f,0x77,0x7f,0x87,0x8f,0x97,0x9f,0xaf,0xbf,0xcf,0xdf,0xef,0xff,
/*0x40*/ 0x00,0x0f,0x06,0x00,0xf5,0x28,0x5c,0x51,0xf5,0x28,0x5c,0x51,0x00,0x00,0x00,0x00,
/*0x50*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xff,0x00,0x00,0x00,
/*0x60*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x11,0x11,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x70*/ 0xff,0x77,0x77,0x00,0x00,0x00,0x00,0x00,0x16,0x16,0x16,0x16,0x00,0x00,0x00,0x00,
/*0x80*/ 0x37,0x37,0x1b,0x05,0x00,0x07,0x00,0x09,0x00,0x00,0x08,0x06,0x00,0x46,0x00,0x00,
/*0x90*/ 0xaa,0x1c,0x18,0xff,0xaa,0x3c,0xff,0xff,0xaa,0x1b,0x00,0x00,0xaa,0x3b,0x00,0x00,
/*0xa0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x01,
/*0xb0*/ 0x00,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x32,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xc0*/ 0x37,0x37,0x1b,0x05,0x00,0x07,0x00,0x09,0x00,0x00,0x08,0x06,0x00,0x46,0x00,0x00,
/*0xd0*/ 0xaa,0x1c,0x18,0xff,0xaa,0x3c,0xff,0xff,0xaa,0x1b,0x00,0x00,0xaa,0x3b,0x00,0x00,
/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x01,
/*0xf0*/ 0x00,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x32,0x00,0x00,0x00,0x00,0x00,0x00
};

static unsigned char NVP6114_B5_NTSC[] = {
      // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0a 0x0b 0x0c 0x0d 0x0e 0x0f
/*0x00*/ 0xe0,0x0f,0x0c,0x1f,0x00,0x24,0x60,0x80,0x50,0x38,0x0f,0x00,0x04,0x10,0x30,0x00,
/*0x10*/ 0x06,0x06,0x00,0x80,0x37,0x80,0x49,0x37,0xef,0xdf,0xdf,0x08,0x50,0x0c,0xff,0x88,
/*0x20*/ 0x84,0x20,0x23,0x00,0x2a,0xdd,0xf0,0x57,0x90,0x70,0x52,0x78,0x00,0x68,0x00,0x07,
/*0x30*/ 0xe0,0x43,0xa2,0x00,0x00,0x15,0x25,0x00,0x00,0x02,0x02,0x00,0x00,0x00,0x00,0x00,
/*0x40*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x00,0x44,0xaa,0x00,0x00,0x00,0x00,0x00,
/*0x50*/ 0x04,0xff,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x60,0x00,0x00,0x30,
/*0x60*/ 0x53,0x53,0x20,0x00,0x22,0x22,0x22,0x22,0x00,0x00,0x00,0x00,0xff,0xff,0xff,0xff,
/*0x70*/ 0xc0,0x01,0x06,0x06,0x11,0x00,0x0f,0x8f,0x0f,0x0f,0x0f,0x8f,0x0f,0x0f,0x00,0x00,
/*0x80*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x90*/ 0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x48,0x84,0x00,0x80,0x00,0x00,0x00,0x00,
/*0xa0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xb0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xc0*/ 0x10,0x30,0x0c,0x50,0x10,0x34,0x70,0x5c,0x20,0x20,0x30,0x40,0x20,0x20,0x14,0x20,
/*0xd0*/ 0x40,0x50,0x0e,0x00,0x80,0x80,0x00,0x00,0x39,0xb2,0x05,0x00,0xc0,0x00,0x00,0x00,
/*0xe0*/ 0xa0,0x00,0x01,0x01,0x02,0xa0,0x02,0x05,0x04,0x0b,0xa0,0x06,0x17,0x08,0x30,0x00,
/*0xf0*/ 0x09,0xa0,0xf8,0x00,0x00,0x00,0x00,0x00,0x01,0x05,0x87,0x0b,0x8e,0x11,0x64,0x00
};

/***************************************************************************************
 * PAL Common
 ***************************************************************************************/
static unsigned char NVP6114_B0_PAL[] = {
      // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0a 0x0b 0x0c 0x0d 0x0e 0x0f
/*0x00*/ 0x00,0x00,0x20,0x03,0x00,0x00,0xaf,0x00,0x60,0x60,0x60,0x60,0x08,0x08,0x08,0x08,
/*0x10*/ 0x88,0x88,0x88,0x88,0x90,0x90,0x90,0x90,0x00,0x00,0x00,0x00,0x02,0x02,0x02,0x02,
/*0x20*/ 0x00,0x00,0x00,0x00,0x2f,0x92,0x0b,0x43,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x30*/ 0x17,0x17,0x17,0x17,0x2f,0x92,0x0b,0x43,0x0a,0x0a,0x0a,0x0a,0x84,0x84,0x84,0x84,
/*0x40*/ 0x00,0x00,0x00,0x00,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x04,0x04,0x04,0x04,
/*0x50*/ 0x04,0x04,0x04,0x04,0x01,0x10,0x10,0x00,0x64,0x64,0x64,0x64,0x9e,0x9e,0x9e,0x9e,
/*0x60*/ 0x00,0x00,0x00,0x00,0x8d,0x8d,0x8d,0x8d,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x70*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x88,0x88,0x11,0x11,0x00,0x00,0x00,0x00,
/*0x80*/ 0x00,0x00,0x02,0x80,0x04,0x04,0x08,0x04,0x0c,0x00,0x08,0x0e,0x80,0x20,0x0a,0x08,
/*0x90*/ 0x30,0x42,0x80,0x0a,0x7a,0x88,0x6c,0x5e,0x18,0x1f,0x8e,0x94,0xc7,0xa3,0xa0,0x0a,
/*0xa0*/ 0x00,0x00,0x02,0x80,0x04,0x04,0x08,0x04,0x0c,0x00,0x08,0x0e,0x80,0x20,0x0a,0x08,
/*0xb0*/ 0x30,0x42,0x80,0x0a,0x7a,0x88,0x6c,0x5e,0x18,0x1f,0x8e,0x94,0xc7,0xa3,0xa0,0x0a,
/*0xc0*/ 0x01,0x01,0x01,0x01,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x30,0x00,0x00,0x00,0x00,
/*0xd0*/ 0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xe0*/ 0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xf0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};

static unsigned char NVP6114_B1_PAL[] = {
      // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0a 0x0b 0x0c 0x0d 0x0e 0x0f
/*0x00*/ 0x02,0x0f,0x0f,0x0f,0x0f,0x0f,0x1b,0x80,0x03,0x00,0x10,0x32,0x54,0x76,0x00,0x98,
/*0x10*/ 0xba,0xdc,0xfe,0x00,0x00,0x00,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,
/*0x20*/ 0x88,0x88,0x03,0x19,0x18,0x16,0x00,0x00,0x00,0x88,0xff,0x40,0xaa,0xaa,0xaa,0xaa,
/*0x30*/ 0xaa,0x82,0x00,0x00,0x00,0x8c,0xa0,0x00,0x18,0x01,0x80,0x30,0x00,0x00,0x80,0x00,
/*0x40*/ 0x0f,0x0f,0x0f,0x0f,0x11,0xcc,0x81,0x55,0x60,0x00,0x03,0x10,0x00,0x00,0x00,0x00,
/*0x50*/ 0xdd,0x00,0x00,0x00,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x60*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x70*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x80*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x90*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xa0*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xb0*/ 0xff,0xff,0xff,0xff,0x40,0x30,0x40,0x30,0x40,0x30,0x40,0x30,0x00,0x00,0x00,0x00,
/*0xc0*/ 0x10,0x10,0x32,0x32,0x10,0x32,0x54,0x76,0x22,0x88,0x03,0x00,0x60,0x60,0x70,0x70,
/*0xd0*/ 0x00,0x00,0x00,0xff,0x00,0x00,0x00,0x00,0x0e,0x01,0x00,0x01,0x00,0x00,0x00,0x00,
/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x90,0x00,0x00,0x00,0x01,0x0f,0x01,0xff,
/*0xf0*/ 0xab,0x00,0x77,0x0e,0x83,0x70,0xff,0x1a,0x00,0x0e,0x00,0x0e,0xff,0xff,0xff,0x00
};

static unsigned char NVP6114_B2_PAL[] = {
      // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0a 0x0b 0x0c 0x0d 0x0e 0x0f
/*0x00*/ 0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,0x03,0x60,
/*0x10*/ 0x00,0x00,0x00,0x00,0xc0,0x00,0x55,0x55,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x20*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x30*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x40*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x50*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x60*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x70*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x80*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0x90*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xa0*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xb0*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xc0*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xd0*/ 0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,0xff,
/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x90,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xf0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3c,0x00,0x3c,0x00,0xff,0xff,0xff,0x00
};

static unsigned char NVP6114_B3_PAL[] = {
      // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0a 0x0b 0x0c 0x0d 0x0e 0x0f
/*0x00*/ 0xe0,0x0f,0x0c,0x1f,0x00,0x24,0x60,0x80,0x50,0x38,0x0f,0x00,0x04,0x10,0x30,0x00,
/*0x10*/ 0x06,0x06,0x00,0x80,0x37,0x80,0x49,0x37,0xef,0xdf,0xdf,0x08,0x50,0x0c,0x00,0x88,
/*0x20*/ 0x84,0x20,0x23,0x00,0x2a,0xdd,0xf0,0x57,0x90,0x70,0x52,0x78,0x00,0x68,0x00,0x07,
/*0x30*/ 0xe0,0x43,0xa2,0x00,0x00,0x17,0x25,0x00,0x00,0x02,0x02,0x00,0x00,0x00,0x00,0x00,
/*0x40*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x00,0x44,0xaa,0x00,0x00,0x00,0x00,0x00,
/*0x50*/ 0x04,0xff,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x70,0x00,0x00,0x30,
/*0x60*/ 0x53,0x53,0x20,0x00,0x22,0x22,0x22,0x22,0x00,0x00,0x00,0x00,0xff,0xff,0xff,0xff,
/*0x70*/ 0xc0,0x01,0x06,0x06,0x11,0x00,0x0f,0x8f,0x0f,0x0f,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x80*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x90*/ 0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x48,0x84,0x00,0x80,0x00,0x00,0x00,0x00,
/*0xa0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xb0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xc0*/ 0x10,0x10,0x0e,0x70,0x10,0x34,0x70,0x5c,0x40,0x20,0x30,0x40,0x10,0x08,0x04,0x20,
/*0xd0*/ 0x40,0x50,0x0e,0x00,0x80,0x80,0x00,0x00,0x39,0xb2,0x05,0x00,0xc0,0x00,0x00,0x00,
/*0xe0*/ 0xa0,0x00,0x01,0x01,0x02,0xa0,0x02,0x05,0x04,0x0b,0xa0,0x06,0x17,0x08,0x30,0x00,
/*0xf0*/ 0x09,0xa0,0xf8,0x00,0x00,0x00,0x00,0x00,0x01,0x05,0x87,0x0b,0x8e,0x11,0x64,0x00
};

static unsigned char NVP6114_B4_PAL[] = {
      // 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0a 0x0b 0x0c 0x0d 0x0e 0x0f
/*0x00*/ 0x02,0x04,0x06,0x08,0x0c,0x10,0x14,0x18,0x1c,0x20,0x28,0x30,0x38,0x40,0x48,0x50,
/*0x10*/ 0x58,0x60,0x68,0x70,0x78,0x7f,0x87,0x8f,0x97,0x9f,0xaf,0xbf,0xcf,0xdf,0xef,0xff,
/*0x20*/ 0x01,0x03,0x05,0x07,0x0b,0x0f,0x13,0x17,0x1b,0x1f,0x27,0x2f,0x37,0x3f,0x47,0x4f,
/*0x30*/ 0x57,0x5f,0x67,0x6f,0x77,0x7f,0x87,0x8f,0x97,0x9f,0xaf,0xbf,0xcf,0xdf,0xef,0xff,
/*0x40*/ 0x00,0x0f,0x06,0x00,0x88,0x88,0x88,0x51,0x88,0x88,0x88,0x51,0x00,0x00,0x00,0x00,
/*0x50*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xff,0x00,0x00,0x00,
/*0x60*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x11,0x11,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x70*/ 0xff,0xaa,0xaa,0x00,0x00,0x00,0x00,0x00,0x16,0x16,0x16,0x16,0x00,0x00,0x00,0x00,
/*0x80*/ 0x37,0x37,0x1b,0x05,0x00,0x07,0x00,0x09,0x00,0x00,0x08,0x06,0x00,0x46,0x00,0x00,
/*0x90*/ 0xaa,0x1c,0x18,0xff,0xaa,0x3c,0xff,0xff,0xaa,0x1b,0x00,0x00,0xaa,0x3b,0x00,0x00,
/*0xa0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x01,
/*0xb0*/ 0x00,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x32,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xc0*/ 0x37,0x37,0x1b,0x05,0x00,0x07,0x00,0x09,0x00,0x00,0x08,0x06,0x00,0x46,0x00,0x00,
/*0xd0*/ 0xaa,0x1c,0x18,0xff,0xaa,0x3c,0xff,0xff,0xaa,0x1b,0x00,0x00,0xaa,0x3b,0x00,0x00,
/*0xe0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x80,0x01,
/*0xf0*/ 0x00,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x32,0x00,0x00,0x00,0x00,0x00,0x00
};

static unsigned char NVP6114_B5_PAL[] = {
     //  0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 0x08 0x09 0x0a 0x0b 0x0c 0x0d 0x0e 0x0f
/*0x00*/ 0xe0,0x0f,0x0c,0x1f,0x00,0x24,0x60,0x80,0x50,0x38,0x0f,0x00,0x04,0x10,0x30,0x00,
/*0x10*/ 0x06,0x06,0x00,0x80,0x37,0x80,0x49,0x37,0xef,0xdf,0xdf,0x08,0x50,0x0c,0x00,0x88,
/*0x20*/ 0x84,0x20,0x23,0x00,0x2a,0xdd,0xf0,0x57,0x90,0x70,0x52,0x78,0x00,0x68,0x00,0x07,
/*0x30*/ 0xe0,0x43,0xa2,0x00,0x00,0x17,0x25,0x00,0x00,0x02,0x02,0x00,0x00,0x00,0x00,0x00,
/*0x40*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x04,0x00,0x44,0xaa,0x00,0x00,0x00,0x00,0x00,
/*0x50*/ 0x04,0xff,0xff,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x70,0x00,0x00,0x30,
/*0x60*/ 0x53,0x53,0x20,0x00,0x22,0x22,0x22,0x22,0x00,0x00,0x00,0x00,0xff,0xff,0xff,0xff,
/*0x70*/ 0xc0,0x01,0x06,0x06,0x11,0x00,0x0f,0x8f,0x0f,0x0f,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x80*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0x90*/ 0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x48,0x84,0x00,0x80,0x00,0x00,0x00,0x00,
/*0xa0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xb0*/ 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
/*0xc0*/ 0x10,0x10,0x0e,0x70,0x10,0x34,0x70,0x5c,0x40,0x20,0x30,0x40,0x10,0x08,0x04,0x20,
/*0xd0*/ 0x40,0x50,0x0e,0x00,0x80,0x80,0x00,0x00,0x39,0xb2,0x05,0x00,0xc0,0x00,0x00,0x00,
/*0xe0*/ 0xa0,0x00,0x01,0x01,0x02,0xa0,0x02,0x05,0x04,0x0b,0xa0,0x06,0x17,0x08,0x30,0x00,
/*0xf0*/ 0x09,0xa0,0xf8,0x00,0x00,0x00,0x00,0x00,0x01,0x05,0x87,0x0b,0x8e,0x11,0x64,0x00
};

static int nvp6114_ntsc_common_init(int id)
{
    int ret;

    if(id >= NVP6114_DEV_MAX)
        return -1;

    /* BANK 0 */
    ret = nvp6114_i2c_write(id, 0xff, 0x00);
    if(ret < 0)
        goto exit;
    ret = nvp6114_i2c_array_write(id, 0x00, NVP6114_B0_NTSC, sizeof(NVP6114_B0_NTSC));
    if(ret < 0)
        goto exit;

    /* BANK 1 */
    ret = nvp6114_i2c_write(id, 0xff, 0x01);
    if(ret < 0)
        goto exit;
    ret = nvp6114_i2c_array_write(id, 0x00, NVP6114_B1_NTSC, sizeof(NVP6114_B1_NTSC));
    if(ret < 0)
        goto exit;

    /* BANK 2 */
    ret = nvp6114_i2c_write(id, 0xff, 0x02);
    if(ret < 0)
        goto exit;
    ret = nvp6114_i2c_array_write(id, 0x00, NVP6114_B2_NTSC, sizeof(NVP6114_B2_NTSC));
    if(ret < 0)
        goto exit;

    /* BANK 3 */
    ret = nvp6114_i2c_write(id, 0xff, 0x03);
    if(ret < 0)
        goto exit;
    ret = nvp6114_i2c_array_write(id, 0x00, NVP6114_B3_NTSC, sizeof(NVP6114_B3_NTSC));
    if(ret < 0)
        goto exit;

    /* BANK 4 */
    ret = nvp6114_i2c_write(id, 0xff, 0x04);
    if(ret < 0)
        goto exit;
    ret = nvp6114_i2c_array_write(id, 0x00, NVP6114_B4_NTSC, sizeof(NVP6114_B4_NTSC));
    if(ret < 0)
        goto exit;

    /* BANK 5 */
    ret = nvp6114_i2c_write(id, 0xff, 0x05);
    if(ret < 0)
        goto exit;
    ret = nvp6114_i2c_array_write(id, 0x00, NVP6114_B5_NTSC, sizeof(NVP6114_B5_NTSC));
    if(ret < 0)
        goto exit;

exit:
    return ret;
}

static int nvp6114_pal_common_init(int id)
{
    int ret;

    if(id >= NVP6114_DEV_MAX)
        return -1;

    /* BANK 0 */
    ret = nvp6114_i2c_write(id, 0xff, 0x00);
    if(ret < 0)
        goto exit;
    ret = nvp6114_i2c_array_write(id, 0x00, NVP6114_B0_PAL, sizeof(NVP6114_B0_PAL));
    if(ret < 0)
        goto exit;

    /* BANK 1 */
    ret = nvp6114_i2c_write(id, 0xff, 0x01);
    if(ret < 0)
        goto exit;
    ret = nvp6114_i2c_array_write(id, 0x00, NVP6114_B1_PAL, sizeof(NVP6114_B1_PAL));
    if(ret < 0)
        goto exit;

    /* BANK 2 */
    ret = nvp6114_i2c_write(id, 0xff, 0x02);
    if(ret < 0)
        goto exit;
    ret = nvp6114_i2c_array_write(id, 0x00, NVP6114_B2_PAL, sizeof(NVP6114_B2_PAL));
    if(ret < 0)
        goto exit;

    /* BANK 3 */
    ret = nvp6114_i2c_write(id, 0xff, 0x03);
    if(ret < 0)
        goto exit;
    ret = nvp6114_i2c_array_write(id, 0x00, NVP6114_B3_PAL, sizeof(NVP6114_B3_PAL));
    if(ret < 0)
        goto exit;

    /* BANK 4 */
    ret = nvp6114_i2c_write(id, 0xff, 0x04);
    if(ret < 0)
        goto exit;
    ret = nvp6114_i2c_array_write(id, 0x00, NVP6114_B4_PAL, sizeof(NVP6114_B4_PAL));
    if(ret < 0)
        goto exit;

    /* BANK 5 */
    ret = nvp6114_i2c_write(id, 0xff, 0x05);
    if(ret < 0)
        goto exit;
    ret = nvp6114_i2c_array_write(id, 0x00, NVP6114_B5_PAL, sizeof(NVP6114_B5_PAL));
    if(ret < 0)
        goto exit;

exit:
    return ret;
}

static int nvp6114_software_reset(int id)
{
    int ret;

    if(id >= NVP6114_DEV_MAX)
        return -1;

    ret = nvp6114_i2c_write(id, 0xFF, 0x01); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x48, 0x40); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x49, 0x02); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x48, 0x61); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x49, 0x00); if(ret < 0) goto exit;
    msleep(100);
    ret = nvp6114_i2c_write(id, 0x48, 0x60); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x49, 0x00); if(ret < 0) goto exit;
    msleep(100);

exit:
    return ret;
}

static int nvp6114_system_init(int id, int is_720h)
{
    int ret;

    if(id >= NVP6114_DEV_MAX)
        return -1;

    ret = nvp6114_i2c_write(id, 0xFF, 0x01); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x48, 0x40); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x49, 0x02); if(ret < 0) goto exit;

    if(is_720h) {   ///< 720H or 1280H or 1440H
        ret = nvp6114_i2c_write(id, 0x4A, 0x22); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x4B, 0x20); if(ret < 0) goto exit;
    }
    else {          ///< AHD or 960H or 36M_720H
        ret = nvp6114_i2c_write(id, 0x4A, 0x03); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x4B, 0x10); if(ret < 0) goto exit;
    }

    ret = nvp6114_i2c_write(id, 0x48, 0x61); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x49, 0x00); if(ret < 0) goto exit;
    msleep(100);
    ret = nvp6114_i2c_write(id, 0x48, 0x60); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x49, 0x00); if(ret < 0) goto exit;

    if(is_720h) {  ///< 720H or 1280H or 1440H
        ret = nvp6114_i2c_write(id, 0x3e, 0x00); if(ret < 0) goto exit;
    }
    else {         ///< AHD or 960H or 36M_720H
        ret = nvp6114_i2c_write(id, 0x3e, 0x80); if(ret < 0) goto exit;
    }

    ret = nvp6114_i2c_write(id, 0x38, 0x18); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x38, 0x08); if(ret < 0) goto exit;
    msleep(100);

    ret = nvp6114_software_reset(id); if(ret < 0) goto exit;

exit:
    return ret;
}

static int nvp6114_video_set_ch_960h(int id, int pal, int ch12_960H, int ch34_960H)
{
    int ret;

    if(id >= NVP6114_DEV_MAX)
        return -1;

    if(ch12_960H == ch34_960H) {
        /* Non-Hybrid */
        ret = nvp6114_i2c_write(id, 0xFF, 0x04); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x5F, 0x00); if(ret < 0) goto exit;
    }
    else {
        /* Hybrid 960H + 720P */
        ret = nvp6114_i2c_write(id, 0xFF, 0x04); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x5F, 0x01); if(ret < 0) goto exit;     //each bank setting
    }

	/************ bank 0 diff setting *************/
	ret = nvp6114_i2c_write(id, 0xFF, 0x00); if(ret < 0) goto exit;
	ret = nvp6114_i2c_write(id, 0x54, (pal==1)?0x01:0xf1); if(ret < 0) goto exit;
	if(ch12_960H) {
		ret = nvp6114_i2c_write(id, 0x08, (pal==1)?0xDD:0xA0); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x09, (pal==1)?0xDD:0xA0); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x14, 0x90); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x15, 0x90); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x18, 0x88); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x1A, 0x22); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x1C, (pal==1)?0x02:0x04); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x1D, (pal==1)?0x02:0x04); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x40, (pal==1)?0x00:0x01); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x41, (pal==1)?0x00:0x01); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x48, (pal==1)?0x00:0x00); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x49, (pal==1)?0x00:0x00); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x58, (pal==1)?0x40:0x33); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x59, (pal==1)?0x40:0x33); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x5C, 0x1E); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x5D, 0x1E); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x64, (pal==1)?0x0D:0x08); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x65, (pal==1)?0x0D:0x08); if(ret < 0) goto exit;
	}
	else {
        ret = nvp6114_i2c_write(id, 0x08, 0x60); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x09, 0x60); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x14, 0x9f); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x15, 0x9f); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x18, 0x00); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x1A, 0x33); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x1C, (pal==1)?0x02:0x04); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x1D, (pal==1)?0x02:0x04); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x40, (pal==1)?0x00:0xFD); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x41, (pal==1)?0x00:0xFD); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x48, 0x30); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x49, 0x30); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x58, (pal==1)?0x64:0xa0); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x59, (pal==1)?0x64:0xa0); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x5C, 0x9E); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x5D, 0x9E); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x64, 0x8d); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x65, 0x8d); if(ret < 0) goto exit;
	}

	if(ch34_960H) {
	    ret = nvp6114_i2c_write(id, 0x0A, (pal==1)?0xDD:0xA0); if(ret < 0) goto exit;
	    ret = nvp6114_i2c_write(id, 0x0B, (pal==1)?0xDD:0xA0); if(ret < 0) goto exit;
	    ret = nvp6114_i2c_write(id, 0x16, 0x90); if(ret < 0) goto exit;
	    ret = nvp6114_i2c_write(id, 0x17, 0x90); if(ret < 0) goto exit;
	    ret = nvp6114_i2c_write(id, 0x19, 0x88); if(ret < 0) goto exit;
	    ret = nvp6114_i2c_write(id, 0x1B, 0x22); if(ret < 0) goto exit;
	    ret = nvp6114_i2c_write(id, 0x1E, (pal==1)?0x02:0x04); if(ret < 0) goto exit;
	    ret = nvp6114_i2c_write(id, 0x1F, (pal==1)?0x02:0x04); if(ret < 0) goto exit;
	    ret = nvp6114_i2c_write(id, 0x42, (pal==1)?0x00:0x01); if(ret < 0) goto exit;
	    ret = nvp6114_i2c_write(id, 0x43, (pal==1)?0x00:0x01); if(ret < 0) goto exit;
	    ret = nvp6114_i2c_write(id, 0x4A, (pal==1)?0x00:0x00); if(ret < 0) goto exit;
	    ret = nvp6114_i2c_write(id, 0x4B, (pal==1)?0x00:0x00); if(ret < 0) goto exit;
	    ret = nvp6114_i2c_write(id, 0x5A, (pal==1)?0x40:0x33); if(ret < 0) goto exit;
	    ret = nvp6114_i2c_write(id, 0x5B, (pal==1)?0x40:0x33); if(ret < 0) goto exit;
	    ret = nvp6114_i2c_write(id, 0x5E, 0x1E); if(ret < 0) goto exit;
	    ret = nvp6114_i2c_write(id, 0x5F, 0x1E); if(ret < 0) goto exit;
	    ret = nvp6114_i2c_write(id, 0x66, (pal==1)?0x0D:0x08); if(ret < 0) goto exit;
	    ret = nvp6114_i2c_write(id, 0x67, (pal==1)?0x0D:0x08); if(ret < 0) goto exit;
    }
    else {
        ret = nvp6114_i2c_write(id, 0x0A, 0x60); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x0B, 0x60); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x16, 0x9f); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x17, 0x9f); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x19, 0x00); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x1B, 0x33); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x1E, (pal==1)?0x02:0x04); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x1F, (pal==1)?0x02:0x04); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x42, (pal==1)?0x00:0xFD); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x43, (pal==1)?0x00:0xFD); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x4A, 0x30); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x4B, 0x30); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x5A, (pal==1)?0x64:0xa0); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x5B, (pal==1)?0x64:0xa0); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x5E, 0x9E); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x5F, 0x9E); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x66, 0x8d); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x67, 0x8d); if(ret < 0) goto exit;
    }

	/************ bank 2 diff setting *************/
	ret = nvp6114_i2c_write(id, 0xFF, 0x02); if(ret < 0) goto exit;
	ret = nvp6114_i2c_write(id, 0x12, ((ch34_960H?0x03:0x00)<<2)|((ch12_960H?0x03:0x00))); if(ret < 0) goto exit;
	ret = nvp6114_i2c_write(id, 0x16, (ch12_960H?0x00:0x55)); if(ret < 0) goto exit;
	ret = nvp6114_i2c_write(id, 0x17, (ch34_960H?0x00:0x55)); if(ret < 0) goto exit;

	/************bank 4 diff setting *************/
	ret = nvp6114_i2c_write(id, 0xFF, 0x04); if(ret < 0) goto exit;
	ret = nvp6114_i2c_write(id, 0x5C, ((ch34_960H?0x00:0x0F)<<4)|(ch12_960H?0x00:0x0F)); if(ret < 0) goto exit;
	ret = nvp6114_i2c_write(id, 0x41, ((ch34_960H?0x00:0x03)<<2)|(ch12_960H?0x00:0x03)); if(ret < 0) goto exit;
	ret = nvp6114_i2c_write(id, 0x40, 0x00); if(ret < 0) goto exit;
	if(ch12_960H) {
		ret = nvp6114_i2c_write(id, 0x64, 0x11); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x68, 0x00); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x71, 0x55); if(ret < 0) goto exit;
	}
	else {
		ret = nvp6114_i2c_write(id, 0x64, 0x00); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x68, 0x11); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x71, (pal==1)?0xAA:0x77); if(ret < 0) goto exit;
	}

	if(ch34_960H) {
		ret = nvp6114_i2c_write(id, 0x65, 0x11); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x69, 0x00); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x72, 0x55); if(ret < 0) goto exit;
	}
	else {
		ret = nvp6114_i2c_write(id, 0x65, 0x00); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x69, 0x11); if(ret < 0) goto exit;
		ret = nvp6114_i2c_write(id, 0x72, (pal==1)?0xAA:0x77); if(ret < 0) goto exit;
	}

    if(ch12_960H && ch34_960H) {
    	ret = nvp6114_i2c_write(id, 0x40, 0x60); if(ret < 0) goto exit;
    	//============== FSC_EXT_VAL ===================//
    	ret = nvp6114_i2c_write(id, 0x44, 0x88); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x45, 0x88); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x46, 0x88); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x47, 0x51); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x48, 0x88); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x49, 0x88); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x4a, 0x88); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x4b, 0x51); if(ret < 0) goto exit;
    }
    else if((ch12_960H == 0) && (ch34_960H == 0)) {
    	if(pal == 0) {
    		//============== FSC_EXT_VAL ===================//
    		ret = nvp6114_i2c_write(id, 0x44, 0xf5); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x45, 0x28); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x46, 0x5c); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x47, 0x51); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x48, 0xf5); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x49, 0x28); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x4a, 0x5c); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x4b, 0x51); if(ret < 0) goto exit;
    	}
    	else {
    		//============== FSC_EXT_VAL ===================//
    		ret = nvp6114_i2c_write(id, 0x44, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x45, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x46, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x47, 0x51); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x48, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x49, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x4a, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x4b, 0x51); if(ret < 0) goto exit;
    	}
    }
    else if(ch12_960H) {
    	if(pal == 0) {
    		//============== FSC_EXT_VAL ===================//
    		ret = nvp6114_i2c_write(id, 0x44, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x45, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x46, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x47, 0x51); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x48, 0xf5); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x49, 0x28); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x4a, 0x5c); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x4b, 0x51); if(ret < 0) goto exit;
    	}
    	else {
    		//============== FSC_EXT_VAL ===================//
    		ret = nvp6114_i2c_write(id, 0x44, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x45, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x46, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x47, 0x51); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x48, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x49, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x4a, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x4b, 0x51); if(ret < 0) goto exit;
    	}
    }
    else if(ch34_960H) {
    	if(pal == 0) {
    		//============== FSC_EXT_VAL ===================//
    		ret = nvp6114_i2c_write(id, 0x44, 0xf5); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x45, 0x28); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x46, 0x5c); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x47, 0x51); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x48, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x49, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x4a, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x4b, 0x51); if(ret < 0) goto exit;
    	}
    	else {
    		//============== FSC_EXT_VAL ===================//
    		ret = nvp6114_i2c_write(id, 0x44, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x45, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x46, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x47, 0x51); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x48, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x49, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x4a, 0x88); if(ret < 0) goto exit;
    		ret = nvp6114_i2c_write(id, 0x4b, 0x51); if(ret < 0) goto exit;
    	}
    }

    /************ bank 3 diff setting *************/
    ret = nvp6114_i2c_write(id, 0xFF, 0x03); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x53, ((ch34_960H?0x03:0x00)<<2)|(ch12_960H?0x03:0x00)); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x2C, (pal==1)?0x00:0x04); if(ret < 0) goto exit;
    if(ch12_960H == 0 && ch34_960H == 0) {
    	//================== Bank3 =====================//
    	ret = nvp6114_i2c_write(id, 0xff, 0x03); if(ret < 0) goto exit;
    	//========= Mode Enable for Ch 1~2 =============//
    	ret = nvp6114_i2c_write(id, 0x29, 0x70); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x5c, (pal==1)?0x70:0x60); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x62, 0x20); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x05, 0x24); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x1b, 0x08); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x50, 0x04); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x5f, 0x30); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0xD4, 0x80); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0xD5, 0x80); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0xD8, 0x39); if(ret < 0) goto exit;
    	//================ Bank 5 =====================//
    	ret = nvp6114_i2c_write(id, 0xff, 0x05); if(ret < 0) goto exit;
    	//========= Mode Enable for Ch 3~4 =============//
    	ret = nvp6114_i2c_write(id, 0x29, 0x70); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x5c, (pal==1)?0x70:0x60); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x62, 0x20); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x05, 0x24); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x1b, 0x08); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x50, 0x04); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x5f, 0x30); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0xD4, 0x80); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0xD5, 0x80); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0xD8, 0x39); if(ret < 0) goto exit;
    }
    else if(ch12_960H) {
    	//================== Bank3 =====================//
    	ret = nvp6114_i2c_write(id, 0xff, 0x03); if(ret < 0) goto exit;
    	//========= Mode Enable for Ch 1~2 =============//
    	ret = nvp6114_i2c_write(id, 0x29, 0x1F); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x5c, 0x00); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x62, 0x21); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x05, 0x20); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x1b, 0x20); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x50, 0x84); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x5f, 0x00); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0xD4, 0x00); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0xD5, 0x80); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0xD8, 0xb9); if(ret < 0) goto exit;
    	//================ Bank 5 =====================//
    	ret = nvp6114_i2c_write(id, 0xff, 0x05); if(ret < 0) goto exit;
    	//========= Mode Enable for Ch 3~4 =============//
    	ret = nvp6114_i2c_write(id, 0x29, 0x70); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x5c, (pal==1)?0x70:0x60); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x62, 0x20); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x05, 0x24); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x1b, 0x08); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x50, 0x04); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x5f, 0x30); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0xD4, 0x80); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0xD5, 0x80); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0xD8, 0x39); if(ret < 0) goto exit;
    }
    else if(ch34_960H) {
    	//================== Bank3 =====================//
    	ret = nvp6114_i2c_write(id, 0xff, 0x03); if(ret < 0) goto exit;
    	//========= Mode Enable for Ch 1~2 =============//
    	ret = nvp6114_i2c_write(id, 0x29, 0x70); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x5c, (pal==1)?0x70:0x60); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x62, 0x20); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x05, 0x24); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x1b, 0x08); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x50, 0x04); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x5f, 0x30); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0xD4, 0x80); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0xD5, 0x80); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0xD8, 0x39); if(ret < 0) goto exit;
    	//================ Bank 5 =====================//
    	ret = nvp6114_i2c_write(id, 0xff, 0x05); if(ret < 0) goto exit;
    	//========= Mode Enable for Ch 3~4 =============//
    	ret = nvp6114_i2c_write(id, 0x29, 0x1F); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x5c, 0x00); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x62, 0x21); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x05, 0x20); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x1b, 0x20); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x50, 0x84); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0x5f, 0x00); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0xD4, 0x00); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0xD5, 0x80); if(ret < 0) goto exit;
    	ret = nvp6114_i2c_write(id, 0xD8, 0xB9); if(ret < 0) goto exit;
    }
    ret = nvp6114_i2c_write(id, 0xff, 0x03); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x35, (pal==1)?0x17:0x15); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0xC1, (pal==1)?0x10:0x30); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0xC2, (pal==1)?0x0E:0x0C); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0xC3, (pal==1)?0x70:0x50); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0xC8, (pal==1)?0x40:0x20); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0xCC, (pal==1)?0x10:0x20); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0xCD, (pal==1)?0x08:0x20); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0xCE, (pal==1)?0x04:0x14); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0xff, 0x05); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x35, (pal==1)?0x17:0x15); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0xC1, (pal==1)?0x10:0x30); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0xC2, (pal==1)?0x0E:0x0C); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0xC3, (pal==1)?0x70:0x50); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0xC8, (pal==1)?0x40:0x20); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0xCC, (pal==1)?0x10:0x20); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0xCD, (pal==1)?0x08:0x20); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0xCE, (pal==1)?0x04:0x14); if(ret < 0) goto exit;

    /************ bank 1 diff setting *************/
    ret = nvp6114_i2c_write(id, 0xFF, 0x01); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x44, 0x11); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x45, ((ch34_960H?0x01:0x0B)<<4)|(ch12_960H?0x01:0x0B)); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x47, ((ch34_960H?0x02:0x05)<<4)|(ch12_960H?0x02:0x05)); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x50, ((ch34_960H?0x07:0x0D)<<4)|(ch12_960H?0x07:0x0D)); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0xD3, ((ch34_960H?0x00:0x03)<<2)|(ch12_960H?0x00:0x03)); if(ret < 0) goto exit;

    /* VPORT output mode and clock delay */
    if(ch12_960H) {
        ret = nvp6114_i2c_write(id, 0xCC, 0x10); if(ret < 0) goto exit;	///< VCLK1_SEL, VCLK_1_DLY_SEL, Dual_Edge Mode
    }
    else {
        ret = nvp6114_i2c_write(id, 0xCC, 0x50); if(ret < 0) goto exit; ///< VCLK1_SEL, VCLK_1_DLY_SEL, Dual_Edge Mode
    }

    if(ch34_960H) {
        ret = nvp6114_i2c_write(id, 0xCD, 0x10); if(ret < 0) goto exit;	///< VCLK2_SEL, VCLK_2_DLY_SEL, Dual_Edge Mode
    }
    else {
        ret = nvp6114_i2c_write(id, 0xCD, 0x50); if(ret < 0) goto exit; ///< VCLK2_SEL, VCLK_2_DLY_SEL, Dual_Edge Mode
    }

exit:
    return ret;
}

static int nvp6114_ntsc_720p_2ch(int id)
{
    int ret;

    if(id >= NVP6114_DEV_MAX)
        return -1;

    /* NTSC Common */
    ret = nvp6114_ntsc_common_init(id);
    if(ret < 0)
        goto exit;

    /* Bank 1 */
    ret = nvp6114_i2c_write(id, 0xFF, 0x01); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0xC0, 0x10); if(ret < 0) goto exit; ///< VPORT1_SEQ1, VPORT1_SEQ2
    ret = nvp6114_i2c_write(id, 0xC1, 0x10); if(ret < 0) goto exit; ///< VPORT1_SEQ3, VPORT1_SEQ4
    ret = nvp6114_i2c_write(id, 0xC2, 0x32); if(ret < 0) goto exit; ///< VPORT2_SEQ1, VPORT2_SEQ2
    ret = nvp6114_i2c_write(id, 0xC3, 0x32); if(ret < 0) goto exit; ///< VPORT2_SEQ3, VPORT2_SEQ4
    ret = nvp6114_i2c_write(id, 0xC8, 0x22); if(ret < 0) goto exit; ///< CH_OUT_SEL1, CH_OUT_SEL2
    ret = nvp6114_i2c_write(id, 0xCC, 0x50); if(ret < 0) goto exit; ///< VCLK1_SEL, VCLK_1_DLY_SEL, Dual_Edge Mode
    ret = nvp6114_i2c_write(id, 0xCD, 0x50); if(ret < 0) goto exit; ///< VCLK2_SEL, VCLK_2_DLY_SEL, Dual_Edge Mode

    ret = nvp6114_system_init(id, 0); if(ret < 0) goto exit;

exit:
    return ret;
}

static int nvp6114_pal_720p_2ch(int id)
{
    int ret;

    if(id >= NVP6114_DEV_MAX)
        return -1;

    /* PAL Common */
    ret = nvp6114_pal_common_init(id);
    if(ret < 0)
        goto exit;

    /* Bank 1 */
    ret = nvp6114_i2c_write(id, 0xFF, 0x01); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0xC0, 0x10); if(ret < 0) goto exit; ///< VPORT1_SEQ1, VPORT1_SEQ2
    ret = nvp6114_i2c_write(id, 0xC1, 0x10); if(ret < 0) goto exit; ///< VPORT1_SEQ3, VPORT1_SEQ4
    ret = nvp6114_i2c_write(id, 0xC2, 0x32); if(ret < 0) goto exit; ///< VPORT2_SEQ1, VPORT2_SEQ2
    ret = nvp6114_i2c_write(id, 0xC3, 0x32); if(ret < 0) goto exit; ///< VPORT2_SEQ3, VPORT2_SEQ4
    ret = nvp6114_i2c_write(id, 0xC8, 0x22); if(ret < 0) goto exit; ///< CH_OUT_SEL1, CH_OUT_SEL2
    ret = nvp6114_i2c_write(id, 0xCC, 0x50); if(ret < 0) goto exit; ///< VCLK1_SEL, VCLK_1_DLY_SEL, Dual_Edge Mode
    ret = nvp6114_i2c_write(id, 0xCD, 0x50); if(ret < 0) goto exit; ///< VCLK2_SEL, VCLK_2_DLY_SEL, Dual_Edge Mode

    ret = nvp6114_system_init(id, 0); if(ret < 0) goto exit;

    ret = nvp6114_software_reset(id); if(ret < 0) goto exit;

exit:
    return ret;
}

int nvp6114_video_init(int id, NVP6114_VMODE_T mode)
{
    int ret;

    if(id >= NVP6114_DEV_MAX)
        return -1;

    switch(mode) {
      //case NVP6114_VMODE_NTSC_720H_2CH:
        case NVP6114_VMODE_NTSC_960H_2CH:
        case NVP6114_VMODE_NTSC_720P_2CH:
        case NVP6114_VMODE_NTSC_960H_720P_2CH:
        case NVP6114_VMODE_NTSC_720P_960H_2CH:
            ret = nvp6114_ntsc_720p_2ch(id);
            break;
      //case NVP6114_VMODE_PAL_720H_2CH:
        case NVP6114_VMODE_PAL_960H_2CH:
        case NVP6114_VMODE_PAL_720P_2CH:
        case NVP6114_VMODE_PAL_960H_720P_2CH:
        case NVP6114_VMODE_PAL_720P_960H_2CH:
            ret = nvp6114_pal_720p_2ch(id);
            break;
        default:
            ret = -1;
            printk("NVP6114#%d driver not support video output mode(%d)!!\n", id, mode);
            break;
    }

    return ret;
}
EXPORT_SYMBOL(nvp6114_video_init);

int nvp6114_video_set_mode(int id, NVP6114_VMODE_T mode)
{
    int ret;

    if(id >= NVP6114_DEV_MAX || mode >= NVP6114_VMODE_MAX)
        return -1;

    switch(mode) {
        case NVP6114_VMODE_NTSC_960H_2CH:
            ret = nvp6114_video_set_ch_960h(id, 0, 1, 1);
            if(ret == 0)
                printk("NVP6114#%d ==> NTSC 960H 72MHz 2CH MODE!!\n", id);
            break;
        case NVP6114_VMODE_PAL_960H_2CH:
            ret = nvp6114_video_set_ch_960h(id, 1, 1, 1);
            if(ret == 0)
                printk("NVP6114#%d ==> PAL 960H 72MHz 2CH MODE!!\n", id);
            break;
        case NVP6114_VMODE_NTSC_720P_2CH:
            ret = nvp6114_video_set_ch_960h(id, 0, 0, 0);
            if(ret == 0)
                printk("NVP6114#%d ==> NTSC 720P 72MHz 2CH MODE!!\n", id);
            break;
        case NVP6114_VMODE_PAL_720P_2CH:
            ret = nvp6114_video_set_ch_960h(id, 1, 0, 0);
            if(ret == 0)
                printk("NVP6114#%d ==> PAL 720P 72MHz 2CH MODE!!\n", id);
            break;
        case NVP6114_VMODE_NTSC_960H_720P_2CH:
            ret = nvp6114_video_set_ch_960h(id, 0, 1, 0);
            if(ret == 0)
                printk("NVP6114#%d ==> NTSC 960H + 720P 2CH MODE!!\n", id);
            break;
        case NVP6114_VMODE_NTSC_720P_960H_2CH:
            ret = nvp6114_video_set_ch_960h(id, 0, 0, 1);
            if(ret == 0)
                printk("NVP6114#%d ==> NTSC 720P + 960H 2CH MODE!!\n", id);
            break;
        case NVP6114_VMODE_PAL_960H_720P_2CH:
            ret = nvp6114_video_set_ch_960h(id, 1, 1, 0);
            if(ret == 0)
                printk("NVP6114#%d ==> PAL 960H + 720P 2CH MODE!!\n", id);
            break;
        case NVP6114_VMODE_PAL_720P_960H_2CH:
            ret = nvp6114_video_set_ch_960h(id, 1, 0, 1);
            if(ret == 0)
                printk("NVP6114#%d ==> PAL 720P + 960H 2CH MODE!!\n", id);
            break;
        default:
            ret = -1;
            printk("NVP6114#%d driver not support video output mode(%d)!!\n", id, mode);
            break;
    }

    return ret;
}
EXPORT_SYMBOL(nvp6114_video_set_mode);

int nvp6114_video_get_mode(int id)
{
    int ret;
    u8 fld_inv, ch_out_sel, std_mode_sel, video_fmt, har_mode;
    NVP6114_VMODE_T mode = NVP6114_VMODE_MAX;

    if(id >= NVP6114_DEV_MAX)
        return -1;

    ret = nvp6114_i2c_write(id, 0xFF, 0x00); if(ret < 0) goto exit;
    fld_inv   = (nvp6114_i2c_read(id, 0x54)>>4) & 0xf;
    video_fmt = nvp6114_i2c_read(id, 0x08) & 0x1f;

    ret = nvp6114_i2c_write(id, 0xFF, 0x01); if(ret < 0) goto exit;
    ch_out_sel   = nvp6114_i2c_read(id, 0xC8);

    ret = nvp6114_i2c_write(id, 0xFF, 0x03); if(ret < 0) goto exit;
    std_mode_sel = nvp6114_i2c_read(id, 0x62) & 0x1;

    ret = nvp6114_i2c_write(id, 0xFF, 0x04); if(ret < 0) goto exit;
    har_mode = nvp6114_i2c_read(id, 0x5C);

    if(har_mode) {  ///< AHD
        if(har_mode == 0xFF) {
            if(fld_inv) {    ///< NTSC
                if(ch_out_sel == 0x22)
                    mode = NVP6114_VMODE_NTSC_720P_2CH;
                else
                    mode = NVP6114_VMODE_NTSC_720P_1CH;
            }
            else {
                if(ch_out_sel == 0x22)
                    mode = NVP6114_VMODE_PAL_720P_2CH;
                else
                    mode = NVP6114_VMODE_PAL_720P_1CH;
            }
        }
        else if(har_mode == 0x0F) {
            if(fld_inv)
                mode = NVP6114_VMODE_NTSC_720P_960H_2CH;
            else
                mode = NVP6114_VMODE_PAL_720P_960H_2CH;
        }
        else if(har_mode == 0xF0) {
            if(fld_inv)
                mode = NVP6114_VMODE_NTSC_960H_720P_2CH;
            else
                mode = NVP6114_VMODE_PAL_960H_720P_2CH;
        }
    }
    else {
        if(std_mode_sel) {  ///< 960H
            if(video_fmt == 0) {    ///< NTSC
                if(ch_out_sel == 0x22)
                    mode = NVP6114_VMODE_NTSC_960H_2CH;
                else if(ch_out_sel == 0x00)
                    mode = NVP6114_VMODE_NTSC_960H_1CH;
                else
                    mode = NVP6114_VMODE_NTSC_960H_4CH;
            }
            else {
                if(ch_out_sel == 0x22)
                    mode = NVP6114_VMODE_PAL_960H_2CH;
                else if(ch_out_sel == 0x00)
                    mode = NVP6114_VMODE_PAL_960H_1CH;
                else
                    mode = NVP6114_VMODE_PAL_960H_4CH;
            }
        }
        else {
            if(video_fmt == 0) {    ///< NTSC
                if(ch_out_sel == 0x22)
                    mode = NVP6114_VMODE_NTSC_720H_2CH;
                else if(ch_out_sel == 0x00)
                    mode = NVP6114_VMODE_NTSC_720H_1CH;
                else
                    mode = NVP6114_VMODE_NTSC_720H_4CH;
            }
            else {
                if(ch_out_sel == 0x22)
                    mode = NVP6114_VMODE_PAL_720H_2CH;
                else if(ch_out_sel == 0x00)
                    mode = NVP6114_VMODE_PAL_720H_1CH;
                else
                    mode = NVP6114_VMODE_PAL_720H_4CH;
            }
        }
    }

exit:
    return mode;
}
EXPORT_SYMBOL(nvp6114_video_get_mode);

int nvp6114_video_mode_support_check(int id, NVP6114_VMODE_T mode)
{
    if(id >= NVP6114_DEV_MAX)
        return 0;

    switch(mode) {
      //case NVP6114_VMODE_NTSC_720H_2CH:
      //case NVP6114_VMODE_PAL_720H_2CH:
        case NVP6114_VMODE_NTSC_960H_2CH:
        case NVP6114_VMODE_PAL_960H_2CH:
        case NVP6114_VMODE_NTSC_720P_2CH:
        case NVP6114_VMODE_PAL_720P_2CH:
        case NVP6114_VMODE_NTSC_960H_720P_2CH:
        case NVP6114_VMODE_NTSC_720P_960H_2CH:
        case NVP6114_VMODE_PAL_960H_720P_2CH:
        case NVP6114_VMODE_PAL_720P_960H_2CH:
            return 1;
        default:
            return 0;
    }

    return 0;
}
EXPORT_SYMBOL(nvp6114_video_mode_support_check);

int nvp6114_video_set_contrast(int id, int ch, u8 value)
{
    int ret;

    if(id >= NVP6114_DEV_MAX || ch >= NVP6114_DEV_CH_MAX)
        return -1;

    ret = nvp6114_i2c_write(id, 0xFF, 0x00);
    if(ret < 0)
        goto exit;

    ret = nvp6114_i2c_write(id, 0x10+ch, value);

exit:
    return ret;
}
EXPORT_SYMBOL(nvp6114_video_set_contrast);

int nvp6114_video_get_contrast(int id, int ch)
{
    int ret;

    if(id >= NVP6114_DEV_MAX || ch >= NVP6114_DEV_CH_MAX)
        return -1;

    ret = nvp6114_i2c_write(id, 0xFF, 0x00);
    if(ret < 0)
        goto exit;

    ret = nvp6114_i2c_read(id, 0x10+ch);

exit:
    return ret;
}
EXPORT_SYMBOL(nvp6114_video_get_contrast);

int nvp6114_video_set_brightness(int id, int ch, u8 value)
{
    int ret;

    if(id >= NVP6114_DEV_MAX || ch >= NVP6114_DEV_CH_MAX)
        return -1;

    ret = nvp6114_i2c_write(id, 0xFF, 0x00);
    if(ret < 0)
        goto exit;

    ret = nvp6114_i2c_write(id, 0x0c+ch, value);

exit:
    return ret;
}
EXPORT_SYMBOL(nvp6114_video_set_brightness);

int nvp6114_video_get_brightness(int id, int ch)
{
    int ret;

    if(id >= NVP6114_DEV_MAX || ch >= NVP6114_DEV_CH_MAX)
        return -1;

    ret = nvp6114_i2c_write(id, 0xFF, 0x00);
    if(ret < 0)
        goto exit;

    ret = nvp6114_i2c_read(id, 0x0c+ch);

exit:
    return ret;
}
EXPORT_SYMBOL(nvp6114_video_get_brightness);

int nvp6114_video_set_saturation(int id, int ch, u8 value)
{
    int ret;

    if(id >= NVP6114_DEV_MAX || ch >= NVP6114_DEV_CH_MAX)
        return -1;

    ret = nvp6114_i2c_write(id, 0xFF, 0x00);
    if(ret < 0)
        goto exit;

    ret = nvp6114_i2c_write(id, 0x3c+ch, value);

exit:
    return ret;
}
EXPORT_SYMBOL(nvp6114_video_set_saturation);

int nvp6114_video_get_saturation(int id, int ch)
{
    int ret;

    if(id >= NVP6114_DEV_MAX || ch >= NVP6114_DEV_CH_MAX)
        return -1;

    ret = nvp6114_i2c_write(id, 0xFF, 0x00);
    if(ret < 0)
        goto exit;

    ret = nvp6114_i2c_read(id, 0x3c+ch);

exit:
    return ret;
}
EXPORT_SYMBOL(nvp6114_video_get_saturation);

int nvp6114_video_set_hue(int id, int ch, u8 value)
{
    int ret;

    if(id >= NVP6114_DEV_MAX || ch >= NVP6114_DEV_CH_MAX)
        return -1;

    ret = nvp6114_i2c_write(id, 0xFF, 0x00);
    if(ret < 0)
        goto exit;

    ret = nvp6114_i2c_write(id, 0x40+ch, value);

exit:
    return ret;
}
EXPORT_SYMBOL(nvp6114_video_set_hue);

int nvp6114_video_get_hue(int id, int ch)
{
    int ret;

    if(id >= NVP6114_DEV_MAX || ch >= NVP6114_DEV_CH_MAX)
        return -1;

    ret = nvp6114_i2c_write(id, 0xFF, 0x00);
    if(ret < 0)
        goto exit;

    ret = nvp6114_i2c_read(id, 0x40+ch);

exit:
    return ret;
}
EXPORT_SYMBOL(nvp6114_video_get_hue);

int nvp6114_video_set_sharpness(int id, int ch, u8 value)
{
    int ret;

    if(id >= NVP6114_DEV_MAX || ch >= NVP6114_DEV_CH_MAX)
        return -1;

    ret = nvp6114_i2c_write(id, 0xFF, 0x00);
    if(ret < 0)
        goto exit;

    ret = nvp6114_i2c_write(id, 0x14+ch, value);

exit:
    return ret;
}
EXPORT_SYMBOL(nvp6114_video_set_sharpness);

int nvp6114_video_get_sharpness(int id, int ch)
{
    int ret;

    if(id >= NVP6114_DEV_MAX || ch >= NVP6114_DEV_CH_MAX)
        return -1;

    ret = nvp6114_i2c_write(id, 0xFF, 0x00);
    if(ret < 0)
        goto exit;

    ret = nvp6114_i2c_read(id, 0x14+ch);

exit:
    return ret;
}
EXPORT_SYMBOL(nvp6114_video_get_sharpness);

int nvp6114_status_get_novid(int id)
{
    int ret;

    if(id >= NVP6114_DEV_MAX)
        return -1;

    ret = nvp6114_i2c_write(id, 0xFF, 0x01);
    if(ret < 0)
        goto exit;

    ret = nvp6114_i2c_read(id, 0xD8);

exit:
    return ret;
}
EXPORT_SYMBOL(nvp6114_status_get_novid);

int nvp6114_status_get_input_video_format(int id, int ch)
{
    int ret = NVP6114_INPUT_VFMT_UNKNOWN;
    int mode;
    u8  reg_0xd8, reg_0xec, reg_0xed, reg_0xee, reg_0xef, reg_0xf0;

    if(id >= NVP6114_DEV_MAX || ch >= NVP6114_DEV_CH_MAX)
        return ret;

    ret = nvp6114_i2c_write(id, 0xFF, 0x01);
    if(ret < 0)
        goto exit;

    reg_0xd8 = nvp6114_i2c_read(id, 0xD8);
    reg_0xec = nvp6114_i2c_read(id, 0xEC);
    reg_0xed = nvp6114_i2c_read(id, 0xED);
    reg_0xee = nvp6114_i2c_read(id, 0xEE);
    reg_0xef = nvp6114_i2c_read(id, 0xEF);
    reg_0xf0 = nvp6114_i2c_read(id, 0xF0);

    mode = nvp6114_video_get_mode(id);

    if(((mode >= NVP6114_VMODE_NTSC_720H_1CH) && (mode <= NVP6114_VMODE_NTSC_960H_4CH)) ||
       ((mode >= NVP6114_VMODE_PAL_720H_1CH)  && (mode <= NVP6114_VMODE_PAL_960H_4CH))  ||
       ((mode == NVP6114_VMODE_NTSC_720H_720P_2CH || mode == NVP6114_VMODE_NTSC_960H_720P_2CH) && (ch <= 1)) ||
       ((mode == NVP6114_VMODE_NTSC_720P_720H_2CH || mode == NVP6114_VMODE_NTSC_720P_960H_2CH) && (ch >= 2)) ||
       ((mode == NVP6114_VMODE_PAL_720H_720P_2CH  || mode == NVP6114_VMODE_PAL_960H_720P_2CH) && (ch <= 1))  ||
       ((mode == NVP6114_VMODE_PAL_720P_720H_2CH  || mode == NVP6114_VMODE_PAL_720P_960H_2CH) && (ch >= 2))) {
        if((reg_0xec>>ch) & 0x01) { ///< AGC Lock
            if(((reg_0xef>>(ch*2))&0x03) == 0x02)       ///< Detect PAL
                ret = NVP6114_INPUT_VFMT_SD_PAL;
            else if(((reg_0xef>>(ch*2))&0x03) == 0x03)  ///< Detect NTSC
                ret = NVP6114_INPUT_VFMT_SD_NTSC;
        }
        else {
            if((reg_0xee>>(ch+4)) & 0x01) {             ///< AHD 25P Detect
                if((((reg_0xed>>(ch+4))&0x01) == 0) && (((reg_0xf0>>(ch*2))&0x03) == 0x03))
                    ret = NVP6114_INPUT_VFMT_AHD_25P;
            }
            else {
                if((((reg_0xed>>(ch+4))&0x01) == 1) && (((reg_0xf0>>(ch*2))&0x03) == 0x03))
                    ret = NVP6114_INPUT_VFMT_AHD_30P;
            }
        }
    }
    else {
        if((reg_0xec>>(ch+4)) & 0x01) {
            ret = NVP6114_INPUT_VFMT_SD;
        }
        else {
            if((reg_0xee>>(ch+4)) & 0x01) {             ///< AHD 25P Detect
                if((((reg_0xed>>(ch+4))&0x01) == 0) && (((reg_0xf0>>(ch*2))&0x03) == 0x03))
                    ret = NVP6114_INPUT_VFMT_AHD_25P;
            }
            else {
                if((((reg_0xed>>(ch+4))&0x01) == 1) && (((reg_0xf0>>(ch*2))&0x03) == 0x03))
                    ret = NVP6114_INPUT_VFMT_AHD_30P;
            }
        }
    }

exit:
    return ret;
}
EXPORT_SYMBOL(nvp6114_status_get_input_video_format);

static int nvp6114_audio_set_master_chan_seq(int id, char *RSEQ)
{
    u16 data;
    int ret;
    //printk("%s\n", __func__);
    data = RSEQ[0];
    ret = nvp6114_i2c_write(id, 0x0A, data); if(ret < 0) goto exit;
    data = RSEQ[1];
    ret = nvp6114_i2c_write(id, 0x0B, data); if(ret < 0) goto exit;
    data = RSEQ[2];
    ret = nvp6114_i2c_write(id, 0x0C, data); if(ret < 0) goto exit;
    data = RSEQ[3];
    ret = nvp6114_i2c_write(id, 0x0D, data); if(ret < 0) goto exit;
    data = RSEQ[4];
    ret = nvp6114_i2c_write(id, 0x0F, data); if(ret < 0) goto exit;
    data = RSEQ[5];
    ret = nvp6114_i2c_write(id, 0x10, data); if(ret < 0) goto exit;
    data = RSEQ[6];
    ret = nvp6114_i2c_write(id, 0x11, data); if(ret < 0) goto exit;
    data = RSEQ[7];
    ret = nvp6114_i2c_write(id, 0x12, data); if(ret < 0) goto exit;
exit:
    return ret;
}

static int nvp6114_audio_set_slave_chan_seq(int id)
{
    int ret;
    // L: 1/2/3/4/5/6/7/8
    ret = nvp6114_i2c_write(id, 0x0A, 0x10); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x0B, 0x32); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x0C, 0x54); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x0D, 0x76); if(ret < 0) goto exit;

    // R: 9/10/11/12/13/14/15/16
    ret = nvp6114_i2c_write(id, 0x0E, 0x98); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x0F, 0xBA); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x10, 0xDC); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x11, 0xFE); if(ret < 0) goto exit;
exit:
    return ret;
}

static int nvp6114_audio_init(int id, int ch_num)
{
    int ret;
    int banksave = 0;
    int cascade  = 0;
    unsigned char bitrates   = AUDIO_BITS_8B;
    unsigned char samplerate = AUDIO_SAMPLERATE_8K;
    //u32 chip_id = ftpmu010_get_attr(ATTR_TYPE_CHIPVER) >> 16;
    int i, j, ch, ch1;
    char RSEQ[8] = {0};
    u32 *temp;
    //u16 *temp1;
    //printk("%s ch %d\n", __func__, ch_num);
    if (ch_num == 16)
        cascade = 1;

    /* NVP6114 just support 2/4/8/16 channel number */
    if (ch_num >= 8){
        bitrates = AUDIO_BITS_16B;
    }
    else if (ch_num == 4){
        bitrates = AUDIO_BITS_16B;
    }
    else if (ch_num == 2){
        bitrates = AUDIO_BITS_16B;
    }

    banksave = nvp6114_i2c_read(id, 0xff);      ///< save bank

    ret = nvp6114_i2c_write(id, 0xff, 0x01); if(ret < 0) goto exit;     ///< select bank 1
    ret = nvp6114_i2c_write(id, 0x22, 0x00); if(ret < 0) goto exit;     ///< Audio No MIXed out - Gain 0 (AOGAIN=0)
    ret = nvp6114_i2c_write(id, 0x23, 0x19); if(ret < 0) goto exit;     ///< Audio No MIXed out - No audio Output (MIX_OUTSEL=25)
    ret = nvp6114_i2c_write(id, 0x01, 0x08); if(ret < 0) goto exit;     ///< Audio input gain init - Gain 1.0
    ret = nvp6114_i2c_write(id, 0x02, 0x08); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x03, 0x08); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x04, 0x08); if(ret < 0) goto exit;

    ret = nvp6114_i2c_write(id, 0xd5, 0x01); if(ret < 0) goto exit;     ///< set ACLK_PB is master = 0x1, slave = 0x0

    if (cascade) {
        // at gm8210, 0(0x66)/2(0x62) is master --> first stage, 1(0x64)/3(0x60) is slave --> last stage
        // at gm8287, 0(0x64) is master --> first stage, 1(0x66) is slave --> last stage
        // at gm8282, 0(0x60) is master --> first stage, 1(0x64) is slave --> last stage
        if ((id == 1)||(id == 3)) { // configure slave
            ret = nvp6114_i2c_write(id, 0x06, 0x19); if(ret < 0) goto exit;                                         ///< RM cascade last stage
            ret = nvp6114_i2c_write(id, 0x07, 0x00 | (samplerate << 3) | (bitrates << 2)); if(ret < 0) goto exit;   ///< RM master
            ret = nvp6114_i2c_write(id, 0x13, 0x00 | (samplerate << 3) | (bitrates << 2)); if(ret < 0) goto exit;   ///< PB slave
        }
        else {                      // configure master
            ret = nvp6114_i2c_write(id, 0x06, 0x1a); if(ret < 0) goto exit;                                         ///< RM cascade first stage
            ret = nvp6114_i2c_write(id, 0x07, 0x80 | (samplerate << 3) | (bitrates << 2)); if(ret < 0) goto exit;   ///< RM master
            ret = nvp6114_i2c_write(id, 0x13, 0x00 | (samplerate << 3) | (bitrates << 2)); if(ret < 0) goto exit;   ///< PB slave
        }
    }
    else {
		ret = nvp6114_i2c_write(id, 0x23, 0x20 | 0x10); if(ret < 0) goto exit;
        ret = nvp6114_i2c_write(id, 0x06, 0x1B); if(ret < 0) goto exit;                                             ///< RM single operation (CHIP_STAGE=3)
        ret = nvp6114_i2c_write(id, 0x07, 0x80 | (samplerate << 3) | (bitrates << 2)); if(ret < 0) goto exit;       ///< RM master
        ret = nvp6114_i2c_write(id, 0x13, 0x00 | (samplerate << 3) | (bitrates << 2)); if(ret < 0) goto exit;       ///< PB slave
    }

    if (2 == ch_num) {
        ret = nvp6114_i2c_write(id, 0x08, 0x00); if(ret < 0) goto exit;            ///< RM channel number 2
    } else if (4 == ch_num) {
        ret = nvp6114_i2c_write(id, 0x08, 0x01); if(ret < 0) goto exit;            ///< RM channel number 4
    } else if (8 == ch_num) {
        ret = nvp6114_i2c_write(id, 0x08, 0x02); if(ret < 0) goto exit;            ///< RM channel number 8
    } else if (16 == ch_num) {
        ret = nvp6114_i2c_write(id, 0x08, 0x03); if(ret < 0) goto exit;            ///< RM channel number 16
    }

    if (cascade) {
        if ((id == 0)||(id == 2)) {     // 0/2 is master, configure master
            for(i = 0; i < 4; i++) {
                j = i * 2;
                ch = nvp6114_vin_to_ch(id, j);
                ch1 = nvp6114_vin_to_ch(id, j+1);
                RSEQ[i] = (ch1 << 4 | ch);

                ch = nvp6114_vin_to_ch(id + 1, j);
                ch1 = nvp6114_vin_to_ch(id + 1, j+1);
                ch += 8;
                ch1 += 8;
                RSEQ[i+4] = (ch1 << 4 | ch);
            }
            for (i = 0; i < 8; i++)
                SWAP_2CHANNEL(RSEQ[i]);

            for (i = 0; i < 2; i++) {
                j = i*4;
                temp = (u32 *)&RSEQ[j];
                SWAP_8CHANNEL(*temp);
            }
            ret = nvp6114_audio_set_master_chan_seq(id, RSEQ);
        }
        else    // 1/3 is slave
            ret = nvp6114_audio_set_slave_chan_seq(id);
    }

    if (audio_chnum == 8) {
        RSEQ[0] = 0x23;
        RSEQ[1] = 0x01;
        RSEQ[2] = 0x98;
        RSEQ[3] = 0xba;
        RSEQ[4] = 0x67;
        RSEQ[5] = 0x45;
        RSEQ[6] = 0xdc;
        RSEQ[7] = 0xfe;

        ret = nvp6114_audio_set_master_chan_seq(id, RSEQ);
    }

    if (audio_chnum == 4) {
        RSEQ[0] = 0x01;
        RSEQ[1] = 0x45;
        RSEQ[2] = 0x67;
        RSEQ[3] = 0x89;
        RSEQ[4] = 0x23;
        RSEQ[5] = 0xab;
        RSEQ[6] = 0xcd;
        RSEQ[7] = 0xef;

        ret = nvp6114_audio_set_master_chan_seq(id, RSEQ);
    }

    ret = nvp6114_i2c_write(id, 0x23, 0x10); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0x22, 0x08); if(ret < 0) goto exit;          ///< Audio No MIXed out - Gain 1.0 (AOGAIN=8)
    ret = nvp6114_i2c_write(id, 0x14, 0x00); if(ret < 0) goto exit;          ///< playback select channel - channel 0 (PB_SEL=0)

    ret = nvp6114_i2c_write(id, 0x24, 0x14); if(ret < 0) goto exit;          ///set mic_1's data to i2s_sp left channel
    ret = nvp6114_i2c_write(id, 0x25, 0x15); if(ret < 0) goto exit;          ///set mic_2's data to i2s_sp right channel

    ret = nvp6114_i2c_write(id, 0xff, banksave); if(ret < 0) goto exit;      ///< restore bank setting

exit:
    return ret;
}

static int nvp6114_audio_set_sample_rate(int id, NVP6114_SAMPLERATE_T samplerate)
{
    int banksave, data, umask;
    int ret;

    banksave = nvp6114_i2c_read(id, 0xff);      ///< save bank

    ret = nvp6114_i2c_write(id, 0xff, 0x01); if(ret < 0) goto exit;          ///< select bank 1
    data = nvp6114_i2c_read(id, 0x07);
    umask = (unsigned char)(AUDIO_SAMPLERATE_16K << 3);
    data &= ~umask;
    data |= (samplerate << 3);
    ret = nvp6114_i2c_write(id, 0x07, data); if(ret < 0) goto exit;

    data = nvp6114_i2c_read(id, 0x13);
    umask = (unsigned char)(AUDIO_SAMPLERATE_16K << 3);
    data &= ~umask;
    data |= (samplerate << 3);
    ret = nvp6114_i2c_write(id, 0x13, data); if(ret < 0) goto exit;

    ret = nvp6114_i2c_write(id, 0xff, banksave); if(ret < 0) goto exit;      ///< restore bank setting

exit:
    return ret;
}

static int nvp6114_audio_set_sample_size(int id, NVP6114_SAMPLESIZE_T samplesize)
{
    int banksave, data, umask;
    int ret;

    banksave = nvp6114_i2c_read(id, 0xff);      ///< save bank

    ret = nvp6114_i2c_write(id, 0xff, 0x01); if(ret < 0) goto exit;          ///< select bank 1
    data = nvp6114_i2c_read(id, 0x07);
    umask = (unsigned char)(AUDIO_BITS_8B << 2);
    data &= ~umask;
    data |= (samplesize << 2);
    ret = nvp6114_i2c_write(id, 0x07, data); if(ret < 0) goto exit;

    data = nvp6114_i2c_read(id, 0x13);
    umask = (unsigned char)(AUDIO_BITS_8B << 2);
    data &= ~umask;
    data |= (samplesize << 2);
    ret = nvp6114_i2c_write(id, 0x13, data); if(ret < 0) goto exit;

    ret = nvp6114_i2c_write(id, 0xff, banksave); if(ret < 0) goto exit;      ///< restore bank setting

exit:
    return ret;
}

int nvp6114_audio_set_mute(int id, int on)
{
    int banksave;
    int ret;

    banksave = nvp6114_i2c_read(id, 0xff);      ///< save bank
    ret = nvp6114_i2c_write(id, 0xff, 0x01);  if(ret < 0) goto exit;             ///< select bank 1
    ret = nvp6114_i2c_write(id, 0x22, on ? 0x00 : 0x08); if(ret < 0) goto exit;  ///< Audio No MIXed out - Gain 0|1 (AOGAIN=0|1)
    ret = nvp6114_i2c_write(id, 0xff, banksave); if(ret < 0) goto exit;          ///< restore bank setting

exit:
    return ret;
}
EXPORT_SYMBOL(nvp6114_audio_set_mute);

int nvp6114_audio_get_mute(int id)
{
    int banksave, aogain;
    int ret;

    banksave = nvp6114_i2c_read(id, 0xff);       ///< save bank

    ret = nvp6114_i2c_write(id, 0xff, 0x01); if(ret < 0) goto exit;    ///< select bank 1
    aogain = nvp6114_i2c_read(id, 0x22);
    aogain = aogain&0x0f;// >> 4;

    nvp6114_i2c_write(id, 0xff, banksave);       ///< restore bank setting

    return aogain;

exit:
    return ret;
}
EXPORT_SYMBOL(nvp6114_audio_get_mute);

int nvp6114_audio_set_volume(int id, int volume)
{
    int banksave;
    int ret;

    banksave = nvp6114_i2c_read(id, 0xff);      ///< save bank
    ret = nvp6114_i2c_write(id, 0xff, 0x01);  if(ret < 0) goto exit;             ///< select bank 1
    ret = nvp6114_i2c_write(id, 0x22, (volume&0x0f)); if(ret < 0) goto exit;     ///< AOGAIN setting
    ret = nvp6114_i2c_write(id, 0xff, banksave); if(ret < 0) goto exit;          ///< restore bank setting

exit:
    return ret;
}
EXPORT_SYMBOL(nvp6114_audio_set_volume);

int nvp6114_audio_get_output_ch(int id)
{
    int banksave, ch;
    int ret;

    banksave = nvp6114_i2c_read(id, 0xff);       ///< save bank

    ret = nvp6114_i2c_write(id, 0xff, 0x01); if(ret < 0) goto exit;    ///< select bank 1
    ch = nvp6114_i2c_read(id, 0x23);
    ch &= 0x1f;

    nvp6114_i2c_write(id, 0xff, banksave);       ///< restore bank setting

    return ch;

exit:
    return ret;
}
EXPORT_SYMBOL(nvp6114_audio_get_output_ch);

int nvp6114_audio_set_output_ch(int id, int ch)
{
    int banksave, data;
    int ret;

    banksave = nvp6114_i2c_read(id, 0xff);      ///< save bank
    ret = nvp6114_i2c_write(id, 0xff, 0x01);  if(ret < 0) goto exit;             ///< select bank 1
    data = nvp6114_i2c_read(id, 0x23);
    data &= 0x20;
    data |= ch;
    ret = nvp6114_i2c_write(id, 0x23, data); if(ret < 0) goto exit;              ///< MIX_OUTSEL
    ret = nvp6114_i2c_write(id, 0xff, banksave); if(ret < 0) goto exit;          ///< restore bank setting

exit:
    return ret;
}
EXPORT_SYMBOL(nvp6114_audio_set_output_ch);

int nvp6114_audio_set_play_ch(int id, unsigned char ch)
{
    int banksave;
    int ret;

    banksave = nvp6114_i2c_read(id, 0xff);      ///< save bank
    ret = nvp6114_i2c_write(id, 0xff, 0x01); if(ret < 0) goto exit;          ///< select bank 1
    ret = nvp6114_i2c_write(id, 0x14, (ch & 0x0F)); if(ret < 0) goto exit;
    ret = nvp6114_i2c_write(id, 0xff, banksave); if(ret < 0) goto exit;      ///< restore bank setting

exit:
    return ret;
}
EXPORT_SYMBOL(nvp6114_audio_set_play_ch);

int nvp6114_audio_set_mode(int id, NVP6114_VMODE_T mode, NVP6114_SAMPLESIZE_T samplesize, NVP6114_SAMPLERATE_T samplerate)
{
    int ch_num = 0;
    int ret;

    ch_num = audio_chnum;
    if(ch_num < 0)
        return -1;

    /* nvp6114 audio initialize */
    ret = nvp6114_audio_init(id, ch_num); if(ret < 0) goto exit;

    /* set audio sample rate */
    ret = nvp6114_audio_set_sample_rate(id, samplerate); if(ret < 0) goto exit;

    /* set audio sample size */
    ret = nvp6114_audio_set_sample_size(id, samplesize); if(ret < 0) goto exit;

    /* set nvp6114 AOGAIN mute */
    //ret = nvp6114_audio_set_mute(id, 0); if(ret < 0) goto exit;

exit:
    return ret;
}
EXPORT_SYMBOL(nvp6114_audio_set_mode);

